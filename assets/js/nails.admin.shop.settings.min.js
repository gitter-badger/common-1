var NAILS_Admin_Shop_Settings;NAILS_Admin_Shop_Settings=function(){this.init=function(){this._init_sortable();this._init_delete();this._init_adds();this._init_submits();this._init_warehouse_collection();$("td.tax_rate select").chosen({width:"100%"});$("select.chosen-base").chosen({no_results_text:"Ensure currency is active. No currencies match",width:"100%"});$("select.chosen-active").chosen({width:"100%"})};this._init_sortable=function(){var e=this;$("#existing-shipping-methods tbody").sortable({handle:"td:first",stop:function(){e._set_order_ship()}})};this._init_delete=function(){$(document).on("click","a.delete-row",function(){var e=$(this);$("<div>").text("Are you sure you wish to delete this item?").dialog({title:"Confirm Delete",resizable:!1,draggable:!1,modal:!0,dialogClass:"no-close",buttons:{Delete:function(){e.closest("tr").remove();$(this).dialog("close");$("<div>").text("The item was removed from the interface and will be deleted when you save changes.").dialog({title:"Remember to Save Changes!",resizable:!1,draggable:!1,modal:!0,buttons:{Ok:function(){$(this).dialog("close")}}})},Cancel:function(){$(this).dialog("close")}}});return!1})};this._init_adds=function(){var e=this;$("#add-new-shipping").on("click",function(){var t=$("#existing-shipping-methods tbody tr").length+1,n=Mustache.render($("#template-new-shipping").html(),{counter:t});$("#existing-shipping-methods tbody").append(n);$("#existing-shipping-methods tbody").sortable("refresh");$("td.tax_rate select").chosen({width:"100%"});e._set_order_ship();return!1});$("#add-new-tax-rate").on("click",function(){var e=$("#existing-tax-rates tbody tr").length+1,t=Mustache.render($("#template-new-tax-rate").html(),{counter:e});$("#existing-tax-rates tbody").append(t);return!1})};this._init_warehouse_collection=function(){$("#shop-settings-warehouse-collection .toggle").on("toggle",function(e,t){if(t){$("#warehouse-collection-address").show();_nails.add_stripes()}else $("#warehouse-collection-address").hide()})};this._set_order_ship=function(){var e=0;$("#existing-shipping-methods .order-handle input.order").each(function(){$(this).val(e);e++})};this._init_submits=function(){$("#form-shipping-methods").on("submit",function(){var e=0,t;$(this).find("tbody tr").each(function(){t=$(this).find("td.courier input").val();if(!t.length){$(this).find("td.courier").addClass("error");e++}else $(this).find("td.courier").removeClass("error");t=$(this).find("td.method input").val();if(!t.length){$(this).find("td.method").addClass("error");e++}else $(this).find("td.method").removeClass("error");t=parseInt($(this).find("td.default_price input").val(),10);if(t<0){$(this).find("td.default_price").addClass("error");e++}else $(this).find("td.default_price").removeClass("error");t=parseInt($(this).find("td.default_price_additional input").val(),10);if(t<0){$(this).find("td.default_price_additional").addClass("error");e++}else $(this).find("td.default_price_additional").removeClass("error")});if(e){alert("Please check highlighted fields for errors:\n\n- A courier must be provided\n- A method must be provided\n- Price and 1+ Price must be positive");return!1}return!0});$("#form-tax-rates").on("submit",function(){var e=0,t;$(this).find("tbody tr").each(function(){t=$(this).find("td.label input").val();if(!t.length){$(this).find("td.label").addClass("error");e++}else $(this).find("td.label").removeClass("error");t=parseInt($(this).find("td.rate input").val(),10);if(t>1||t<0){$(this).find("td.rate").addClass("error");e++}else $(this).find("td.rate").removeClass("error")});if(e){alert("Please check highlighted fields for errors:\n\n- A label must be provided\n-Rate must be a numeric in the range 0-1");return!1}return!0})}};